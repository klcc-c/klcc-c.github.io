<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"klcc.cc","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.9.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="使用git管理代码提交本地仓库">
<meta property="og:type" content="article">
<meta property="og:title" content="git管理项目、登录注册功能实现">
<meta property="og:url" content="https://klcc.cc/1ead43c8.html">
<meta property="og:site_name" content="klcc">
<meta property="og:description" content="使用git管理代码提交本地仓库">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://klcc-img-1251900471.cos.ap-chengdu.myqcloud.com/img/image-20220421183157663.png">
<meta property="og:image" content="https://klcc-img-1251900471.cos.ap-chengdu.myqcloud.com/img/image-20220421183253531.png">
<meta property="og:image" content="https://klcc-img-1251900471.cos.ap-chengdu.myqcloud.com/img/image-20220421183421979.png">
<meta property="og:image" content="https://klcc-img-1251900471.cos.ap-chengdu.myqcloud.com/img/image-20220425214754903.png">
<meta property="article:published_time" content="2022-02-08T03:18:08.406Z">
<meta property="article:modified_time" content="2022-04-27T13:36:56.504Z">
<meta property="article:author" content="klcc">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://klcc-img-1251900471.cos.ap-chengdu.myqcloud.com/img/image-20220421183157663.png">


<link rel="canonical" href="https://klcc.cc/1ead43c8.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://klcc.cc/1ead43c8.html","path":"1ead43c8.html","title":"git管理项目、登录注册功能实现"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>git管理项目、登录注册功能实现 | klcc</title>
  

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?725ad6b586949dd6e89c022fb8d748f7"></script>



  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">klcc</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">28</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">22</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">141</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8git%E7%AE%A1%E7%90%86%E4%BB%A3%E7%A0%81"><span class="nav-number">1.</span> <span class="nav-text">使用git管理代码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93"><span class="nav-number">1.1.</span> <span class="nav-text">提交本地仓库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4%E5%88%B0gitee"><span class="nav-number">1.2.</span> <span class="nav-text">提交到gitee</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E4%BB%93%E5%BA%93"><span class="nav-number">1.2.1.</span> <span class="nav-text">创建仓库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%85%8D%E5%AF%86"><span class="nav-number">1.2.2.</span> <span class="nav-text">配置免密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81"><span class="nav-number">1.2.3.</span> <span class="nav-text">提交代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%85%BE%E8%AE%AF%E4%BA%91%E7%9F%AD%E4%BF%A1%E7%94%B3%E8%AF%B7"><span class="nav-number">2.</span> <span class="nav-text">腾讯云短信申请</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C%E5%8A%9F%E8%83%BD"><span class="nav-number">3.</span> <span class="nav-text">登录注册功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81%E6%89%8B%E6%9C%BA%E5%8F%B7%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="nav-number">4.</span> <span class="nav-text">验证手机号是否存在</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#views-py"><span class="nav-number">4.1.</span> <span class="nav-text">views.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#urls-py"><span class="nav-number">4.2.</span> <span class="nav-text">urls.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E8%B7%AF%E7%94%B1"><span class="nav-number">4.3.</span> <span class="nav-text">总路由</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"><span class="nav-number">5.</span> <span class="nav-text">注册登录页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80-%E9%A1%B5%E9%9D%A2"><span class="nav-number">5.1.</span> <span class="nav-text">方式一(页面)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%8C-%E7%BB%84%E4%BB%B6%E3%80%81%E6%A8%A1%E6%80%81%E6%A1%86"><span class="nav-number">5.2.</span> <span class="nav-text">方式二(组件、模态框)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Login-vue"><span class="nav-number">5.2.1.</span> <span class="nav-text">Login.vue</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Register-vue"><span class="nav-number">5.2.2.</span> <span class="nav-text">Register.vue</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Header-vue"><span class="nav-number">5.2.3.</span> <span class="nav-text">Header.vue</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#vue%E4%B8%AD%E8%B7%B3%E8%BD%AC%E6%96%B9%E5%BC%8F"><span class="nav-number">5.3.</span> <span class="nav-text">vue中跳转方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Banner-vue"><span class="nav-number">5.4.</span> <span class="nav-text">Banner.vue</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E6%96%B9%E5%BC%8F%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD"><span class="nav-number">6.</span> <span class="nav-text">多方式登录功能</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1"><span class="nav-number">6.1.</span> <span class="nav-text">路由</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E7%B1%BB"><span class="nav-number">6.2.</span> <span class="nav-text">序列化类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E7%B1%BB"><span class="nav-number">6.3.</span> <span class="nav-text">视图类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85%E8%85%BE%E8%AE%AF%E4%BA%91%E7%9F%AD%E4%BF%A1%E5%8F%91%E9%80%81"><span class="nav-number">7.</span> <span class="nav-text">二次封装腾讯云短信发送</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%91%E9%80%81%E7%9F%AD%E4%BF%A1%E6%8E%A5%E5%8F%A3"><span class="nav-number">8.</span> <span class="nav-text">发送短信接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1-1"><span class="nav-number">8.1.</span> <span class="nav-text">路由</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE"><span class="nav-number">8.2.</span> <span class="nav-text">视图</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%AD%E4%BF%A1%E7%99%BB%E5%BD%95%E6%8E%A5%E5%8F%A3"><span class="nav-number">9.</span> <span class="nav-text">短信登录接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E7%B1%BB-1"><span class="nav-number">9.1.</span> <span class="nav-text">视图类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E7%B1%BB-1"><span class="nav-number">9.2.</span> <span class="nav-text">序列化类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%AD%E4%BF%A1%E6%B3%A8%E5%86%8C%E6%8E%A5%E5%8F%A3"><span class="nav-number">10.</span> <span class="nav-text">短信注册接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1-2"><span class="nav-number">10.1.</span> <span class="nav-text">路由</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E7%B1%BB-2"><span class="nav-number">10.2.</span> <span class="nav-text">视图类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E7%B1%BB-2"><span class="nav-number">10.3.</span> <span class="nav-text">序列化类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2"><span class="nav-number">11.</span> <span class="nav-text">登录注册前端页面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E5%AD%98%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="nav-number">11.1.</span> <span class="nav-text">前端存入数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Header-vue-1"><span class="nav-number">11.2.</span> <span class="nav-text">Header.vue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Login-vue-1"><span class="nav-number">11.3.</span> <span class="nav-text">Login.vue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Register-vue-1"><span class="nav-number">11.4.</span> <span class="nav-text">Register.vue</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="klcc"
      src="/images/head.jpg">
  <p class="site-author-name" itemprop="name">klcc</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">141</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://klcc.cc/1ead43c8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.jpg">
      <meta itemprop="name" content="klcc">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="klcc">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          git管理项目、登录注册功能实现
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
  
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-02-08 11:18:08" itemprop="dateCreated datePublished" datetime="2022-02-08T11:18:08+08:00">2022-02-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>46k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>42 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="使用git管理代码"><a href="#使用git管理代码" class="headerlink" title="使用git管理代码"></a>使用<code>git</code>管理代码</h3><h4 id="提交本地仓库"><a href="#提交本地仓库" class="headerlink" title="提交本地仓库"></a>提交本地仓库</h4><span id="more"></span>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置个人信息</span></span><br><span class="line">git config --global user.name <span class="string">&quot;klcc&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;2564334707@qq.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 后端代码</span></span><br><span class="line">  <span class="comment"># 初始化仓库</span></span><br><span class="line">  <span class="built_in">cd</span> luffy_api</span><br><span class="line">  git init </span><br><span class="line"></span><br><span class="line">  <span class="comment"># 创建过滤文件，内容如下</span></span><br><span class="line">  vim  .gitignore</span><br><span class="line">  .DS_Store</span><br><span class="line">  *.pyc</span><br><span class="line">  logs/*.<span class="built_in">log</span></span><br><span class="line">  .idea/</span><br><span class="line">  __pycache__/</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 提交到版本库</span></span><br><span class="line">  git add .</span><br><span class="line">  git commit -m <span class="string">&quot;轮播功能&quot;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 前端代码 如上操作 但是vue项目在创建的时候是拉取的git 后续只需要提交即可</span></span><br><span class="line">  git add .</span><br><span class="line">  git commit -m <span class="string">&quot;页面主体，轮播功能&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="提交到gitee"><a href="#提交到gitee" class="headerlink" title="提交到gitee"></a>提交到<code>gitee</code></h4><h5 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h5><p>先注册账户:  <a target="_blank" rel="noopener" href="https://gitee.com/signup">https://gitee.com/signup</a>  然后登录</p>
<p><img src="https://klcc-img-1251900471.cos.ap-chengdu.myqcloud.com/img/image-20220421183157663.png" alt="image-20220421183157663"></p>
<p><img src="https://klcc-img-1251900471.cos.ap-chengdu.myqcloud.com/img/image-20220421183253531.png" alt="image-20220421183253531"></p>
<p><img src="https://klcc-img-1251900471.cos.ap-chengdu.myqcloud.com/img/image-20220421183421979.png" alt="image-20220421183421979"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> luffy_api</span><br><span class="line">git remote add origin https://gitee.com/liuzhijin1/luffy_api.git  <span class="comment"># 添加远程仓库</span></span><br><span class="line">git remote -v                 <span class="comment"># 仓库远程仓库</span></span><br><span class="line">git tag -a <span class="string">&quot;v1&quot;</span> -m <span class="string">&quot;轮播功能&quot;</span>  <span class="comment"># 打标签</span></span><br><span class="line">git push orgin --tag v1       <span class="comment"># 提交指定标签</span></span><br><span class="line"></span><br><span class="line">git push -u origin <span class="string">&quot;master&quot;</span>   <span class="comment"># 提交时需要用户名和密码 可以配置免密</span></span><br></pre></td></tr></table></figure>

<h5 id="配置免密"><a href="#配置免密" class="headerlink" title="配置免密"></a>配置免密</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用户名密码的方式</span></span><br><span class="line">git remote rm origin          <span class="comment"># 删除原本的 origin 远程仓库</span></span><br><span class="line"><span class="comment"># 使用用户名密码</span></span><br><span class="line">git remote add origin https://用户名:密码@gitee.com/liuzhijin1/luffy_api.git</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># SSH 方式</span></span><br><span class="line"><span class="comment"># 生成公钥和私钥(默认放在 ~/.ssh目录下id_rsa.pub公钥、id_rsa私钥）</span></span><br><span class="line">ssh-keygen</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拷贝公钥的内容.pub 结尾的文件到gitee中</span></span><br><span class="line"><span class="comment"># 然后配置远程仓库地址</span></span><br><span class="line">git remote add origin git@gitee.com:liuzhijin1/luffy_api.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交代码</span></span><br><span class="line">git push origin --tag v1.1       <span class="comment"># 提交指定标签</span></span><br><span class="line">git push -u origin <span class="string">&quot;master&quot;</span>      <span class="comment"># 提交master</span></span><br></pre></td></tr></table></figure>

<h5 id="提交代码"><a href="#提交代码" class="headerlink" title="提交代码"></a>提交代码</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用SSH方式</span></span><br><span class="line"><span class="comment">## 后端代码</span></span><br><span class="line"><span class="built_in">cd</span> luffy_api</span><br><span class="line">git remote rm origin </span><br><span class="line">git remote add origin git@gitee.com:liuzhijin1/luffy_api.git</span><br><span class="line">git add . </span><br><span class="line">git commit -m <span class="string">&quot;轮播功能&quot;</span></span><br><span class="line">git tag -a <span class="string">&quot;v1&quot;</span> -m <span class="string">&quot;轮播功能&quot;</span> </span><br><span class="line">git push origin <span class="string">&quot;master&quot;</span> --tag v1</span><br><span class="line"></span><br><span class="line"><span class="comment">## 前端代码</span></span><br><span class="line"> <span class="built_in">cd</span> luffycity</span><br><span class="line"> git remote rm origin </span><br><span class="line"> git remote add origin git@gitee.com:liuzhijin1/luffycity.git</span><br><span class="line"> git add .</span><br><span class="line"> git commit -m <span class="string">&quot;轮播功能和主体&quot;</span></span><br><span class="line"> git tag -a <span class="string">&quot;v1&quot;</span> -m <span class="string">&quot;轮播功能和主体&quot;</span></span><br><span class="line"> git push -u origin <span class="string">&quot;master&quot;</span> --tag v1</span><br><span class="line"> </span><br></pre></td></tr></table></figure>


<h3 id="腾讯云短信申请"><a href="#腾讯云短信申请" class="headerlink" title="腾讯云短信申请"></a>腾讯云短信申请</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 申请一个公众号：https://mp.weixin.qq.com/cgi-bin/home?t=home/index&amp;lang=zh_CN&amp;token=2082783786</span></span><br><span class="line"><span class="comment"># 个人，身份证</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问地址申请：https://console.cloud.tencent.com/smsv2/guide</span></span><br><span class="line"><span class="comment"># 步骤</span></span><br><span class="line">创建短信签名</span><br><span class="line">  -签名管理---》创建签名--》使用公众号提交申请---》审核</span><br><span class="line">创建短信正文模板</span><br><span class="line">  -正文模板管理---》创建正文模板--》等审核</span><br><span class="line">发送短信</span><br><span class="line">  -API，SDK</span><br><span class="line">  </span><br><span class="line"><span class="comment"># 发送短信，按照文档来:https://cloud.tencent.com/document/product/382/43196</span></span><br><span class="line"><span class="comment"># api和sdk的区别</span></span><br><span class="line">  -api接口，咱们通过http调用腾讯的发送短信接口，腾讯负责吧短信发送到手机上，http的接口--》基于它来做，比较麻烦，麻烦在请求参数，携带很多，有的时候我们有可能找不到某个参数</span><br><span class="line">  -sdk：使用不同语言封装好了，只需要导入，调用某个函数，传入参数就可以发送，用起来更简单，区分语言，可能官方没有提供sdk</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 发短信sdk的使用</span></span><br><span class="line"><span class="comment"># 3.x的发送短信sdk，tencentcloud 包含的功能更多，不仅仅只能发短信，还能干别的，但是咱们用不到</span></span><br><span class="line">pip install tencentcloud-sdk-python</span><br><span class="line"><span class="comment"># 2.x发送短信sdk：https://cloud.tencent.com/document/product/382/11672</span></span><br><span class="line"><span class="comment"># 只是发短信的sdk，功能少，3.8以后不支持</span></span><br><span class="line">pip install qcloudsms_py</span><br></pre></td></tr></table></figure>


<h3 id="登录注册功能"><a href="#登录注册功能" class="headerlink" title="登录注册功能"></a>登录注册功能</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">多方式登录接口(手机号，邮箱，用户名+密码)</span><br><span class="line">验证手机号是否存在的接口</span><br><span class="line">发送短信验证码接口  借助第三方发送短信，阿里云 腾讯云 容联云</span><br><span class="line">手机号+验证码登录接口</span><br><span class="line">手机号+验证码+密码注册接口</span><br></pre></td></tr></table></figure>

<h3 id="验证手机号是否存在"><a href="#验证手机号是否存在" class="headerlink" title="验证手机号是否存在"></a>验证手机号是否存在</h3><p>该功能写在user  app中</p>
<h4 id="views-py"><a href="#views-py" class="headerlink" title="views.py"></a><code>views.py</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># luffy_api/apps/user/views.py</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ViewSet</span><br><span class="line"><span class="keyword">from</span> rest_framework.decorators <span class="keyword">import</span> action</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> utils.APIResponse <span class="keyword">import</span> APIResponse</span><br><span class="line"><span class="keyword">from</span> rest_framework.exceptions <span class="keyword">import</span> APIException</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserView</span>(<span class="params">ViewSet</span>):</span></span><br><span class="line">    <span class="comment"># get 请求携带手机号 校验手机号</span></span><br><span class="line"><span class="meta">    @action(<span class="params">methods=[<span class="string">&#x27;GET&#x27;</span>], detail=<span class="literal">False</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_mobile</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            mobile = request.query_params.get(<span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line">            User.objects.get(mobile=mobile)</span><br><span class="line">            <span class="keyword">return</span> APIResponse()  <span class="comment"># &#123;code: 100, msg: successfully&#125; 前端判断是否 100 即可</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> APIException(<span class="built_in">str</span>(e))  <span class="comment"># 处理了全局异常</span></span><br></pre></td></tr></table></figure>

<h4 id="urls-py"><a href="#urls-py" class="headerlink" title="urls.py"></a><code>urls.py</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"><span class="keyword">from</span> rest_framework.routers <span class="keyword">import</span> SimpleRouter</span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> UserView</span><br><span class="line"></span><br><span class="line">router = SimpleRouter()</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/mobile/check_mobile</span></span><br><span class="line">router.register(<span class="string">&#x27;mobile&#x27;</span>, UserView, <span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, include(router.urls))</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="总路由"><a href="#总路由" class="headerlink" title="总路由"></a><code>总路由</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"><span class="keyword">from</span> django.views.static <span class="keyword">import</span> serve</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&#x27;api/v1/home/&#x27;</span>, include(<span class="string">&#x27;home.urls&#x27;</span>)),  <span class="comment"># http://127.0.0.1:8000/api/v1/home/banner/</span></span><br><span class="line">    path(<span class="string">&#x27;api/v1/user/&#x27;</span>, include(<span class="string">&#x27;user.urls&#x27;</span>)),  <span class="comment"># http://127.0.0.1:8000/api/v1/user/</span></span><br><span class="line">    path(<span class="string">&#x27;media/&lt;path:path&gt;&#x27;</span>, serve, &#123;<span class="string">&#x27;document_root&#x27;</span>: settings.MEDIA_ROOT&#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="注册登录页面"><a href="#注册登录页面" class="headerlink" title="注册登录页面"></a>注册登录页面</h3><h4 id="方式一-页面"><a href="#方式一-页面" class="headerlink" title="方式一(页面)"></a>方式一(页面)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">// 创建页面 src/views/Login.vue</span><br><span class="line">    &lt;template&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;form action=&quot;&quot;&gt;</span><br><span class="line">          用户名: &lt;p&gt;&lt;input type=&quot;text&quot;&gt;&lt;/p&gt;</span><br><span class="line">          密 码: &lt;p&gt;&lt;input type=&quot;password&quot;&gt;&lt;/p&gt;</span><br><span class="line">          &lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;&lt;/p&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">      name: &quot;Login&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;style scoped&gt;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line"></span><br><span class="line">// 需要使用的跳转的页面</span><br><span class="line">    // 绑定点击事件</span><br><span class="line">    &lt;span @click=&quot;go_login&quot;&gt;登录&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">      methods: &#123;</span><br><span class="line">        // 方法</span><br><span class="line">        go_login()&#123;</span><br><span class="line">          // 跳转到另一个页面 使用 vue-router 跳转到 /login 路由</span><br><span class="line">          this.$router.push(&#x27;/login&#x27;)</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 路由 src/router/index.js</span><br><span class="line">    // 先导入</span><br><span class="line">    import Login from &quot;@/views/Login&quot;;</span><br><span class="line"></span><br><span class="line">    const routes = [</span><br><span class="line">        // 添加该路由 然后就可以访问到 /login</span><br><span class="line">        &#123;</span><br><span class="line">            path: &#x27;/login&#x27;,</span><br><span class="line">            name: &#x27;login&#x27;,</span><br><span class="line">            component: Login</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure>

<h4 id="方式二-组件、模态框"><a href="#方式二-组件、模态框" class="headerlink" title="方式二(组件、模态框)"></a>方式二(组件、模态框)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">采用该方式</span><br><span class="line"></span><br><span class="line">登录注册是弹出模态框 Login Register 两个组件 放到 components 中</span><br><span class="line">Header 为 Login Register 两个组件的父组件</span><br></pre></td></tr></table></figure>

<h5 id="Login-vue"><a href="#Login-vue" class="headerlink" title="Login.vue"></a><code>Login.vue</code></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;login&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">            &lt;i class=&quot;el-icon-close&quot; @click=&quot;close_login&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &lt;div class=&quot;content&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;nav&quot;&gt;</span><br><span class="line">                    &lt;span :class=&quot;&#123;active: login_method === &#x27;is_pwd&#x27;&#125;&quot;</span><br><span class="line">                          @click=&quot;change_login_method(&#x27;is_pwd&#x27;)&quot;&gt;密码登录&lt;/span&gt;</span><br><span class="line">                    &lt;span :class=&quot;&#123;active: login_method === &#x27;is_sms&#x27;&#125;&quot;</span><br><span class="line">                          @click=&quot;change_login_method(&#x27;is_sms&#x27;)&quot;&gt;短信登录&lt;/span&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;el-form v-if=&quot;login_method === &#x27;is_pwd&#x27;&quot;&gt;</span><br><span class="line">                    &lt;el-input</span><br><span class="line">                            placeholder=&quot;用户名/手机号/邮箱&quot;</span><br><span class="line">                            prefix-icon=&quot;el-icon-user&quot;</span><br><span class="line">                            v-model=&quot;username&quot;</span><br><span class="line">                            clearable&gt;</span><br><span class="line">                    &lt;/el-input&gt;</span><br><span class="line">                    &lt;el-input</span><br><span class="line">                            placeholder=&quot;密码&quot;</span><br><span class="line">                            prefix-icon=&quot;el-icon-key&quot;</span><br><span class="line">                            v-model=&quot;password&quot;</span><br><span class="line">                            clearable</span><br><span class="line">                            show-password&gt;</span><br><span class="line">                    &lt;/el-input&gt;</span><br><span class="line">                    &lt;el-button type=&quot;primary&quot;&gt;登录&lt;/el-button&gt;</span><br><span class="line">                &lt;/el-form&gt;</span><br><span class="line">                &lt;el-form v-if=&quot;login_method === &#x27;is_sms&#x27;&quot;&gt;</span><br><span class="line">                    &lt;el-input</span><br><span class="line">                            placeholder=&quot;手机号&quot;</span><br><span class="line">                            prefix-icon=&quot;el-icon-phone-outline&quot;</span><br><span class="line">                            v-model=&quot;mobile&quot;</span><br><span class="line">                            clearable</span><br><span class="line">                            @blur=&quot;check_mobile&quot;&gt;</span><br><span class="line">                    &lt;/el-input&gt;</span><br><span class="line">                    &lt;el-input</span><br><span class="line">                            placeholder=&quot;验证码&quot;</span><br><span class="line">                            prefix-icon=&quot;el-icon-chat-line-round&quot;</span><br><span class="line">                            v-model=&quot;sms&quot;</span><br><span class="line">                            clearable&gt;</span><br><span class="line">                        &lt;template slot=&quot;append&quot;&gt;</span><br><span class="line">                            &lt;span class=&quot;sms&quot; @click=&quot;send_sms&quot;&gt;&#123;&#123; sms_interval &#125;&#125;&lt;/span&gt;</span><br><span class="line">                        &lt;/template&gt;</span><br><span class="line">                    &lt;/el-input&gt;</span><br><span class="line">                    &lt;el-button type=&quot;primary&quot;&gt;登录&lt;/el-button&gt;</span><br><span class="line">                &lt;/el-form&gt;</span><br><span class="line">                &lt;div class=&quot;foot&quot;&gt;</span><br><span class="line">                    &lt;span @click=&quot;go_register&quot;&gt;立即注册&lt;/span&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        name: &quot;Login&quot;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                username: &#x27;&#x27;,</span><br><span class="line">                password: &#x27;&#x27;,</span><br><span class="line">                mobile: &#x27;&#x27;,</span><br><span class="line">                sms: &#x27;&#x27;,</span><br><span class="line">                login_method: &#x27;is_pwd&#x27;,</span><br><span class="line">                sms_interval: &#x27;获取验证码&#x27;,</span><br><span class="line">                is_send: false,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            close_login() &#123;</span><br><span class="line">                this.$emit(&#x27;close&#x27;)</span><br><span class="line">            &#125;,</span><br><span class="line">            go_register() &#123;</span><br><span class="line">                this.$emit(&#x27;go&#x27;)</span><br><span class="line">            &#125;,</span><br><span class="line">            change_login_method(method) &#123;</span><br><span class="line">                this.login_method = method;</span><br><span class="line">            &#125;,</span><br><span class="line">            check_mobile() &#123;</span><br><span class="line">                if (!this.mobile) return;</span><br><span class="line">                if (!this.mobile.match(/^1[3-9][0-9]&#123;9&#125;$/)) &#123;</span><br><span class="line">                    this.$message(&#123;</span><br><span class="line">                        message: &#x27;手机号有误&#x27;,</span><br><span class="line">                        type: &#x27;warning&#x27;,</span><br><span class="line">                        duration: 1000,</span><br><span class="line">                        onClose: () =&gt; &#123;</span><br><span class="line">                            this.mobile = &#x27;&#x27;;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line">                this.is_send = true;</span><br><span class="line">            &#125;,</span><br><span class="line">            send_sms() &#123;</span><br><span class="line"></span><br><span class="line">                if (!this.is_send) return;</span><br><span class="line">                this.is_send = false;</span><br><span class="line">                let sms_interval_time = 60;</span><br><span class="line">                this.sms_interval = &quot;发送中...&quot;;</span><br><span class="line">                let timer = setInterval(() =&gt; &#123;</span><br><span class="line">                    if (sms_interval_time &lt;= 1) &#123;</span><br><span class="line">                        clearInterval(timer);</span><br><span class="line">                        this.sms_interval = &quot;获取验证码&quot;;</span><br><span class="line">                        this.is_send = true; // 重新回复点击发送功能的条件</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        sms_interval_time -= 1;</span><br><span class="line">                        this.sms_interval = `$&#123;sms_interval_time&#125;秒后再发`;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, 1000);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">    .login &#123;</span><br><span class="line">        width: 100vw;</span><br><span class="line">        height: 100vh;</span><br><span class="line">        position: fixed;</span><br><span class="line">        top: 0;</span><br><span class="line">        left: 0;</span><br><span class="line">        z-index: 10;</span><br><span class="line">        background-color: rgba(0, 0, 0, 0.3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .box &#123;</span><br><span class="line">        width: 400px;</span><br><span class="line">        height: 420px;</span><br><span class="line">        background-color: white;</span><br><span class="line">        border-radius: 10px;</span><br><span class="line">        position: relative;</span><br><span class="line">        top: calc(50vh - 210px);</span><br><span class="line">        left: calc(50vw - 200px);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-icon-close &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        font-weight: bold;</span><br><span class="line">        font-size: 20px;</span><br><span class="line">        top: 10px;</span><br><span class="line">        right: 10px;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-icon-close:hover &#123;</span><br><span class="line">        color: darkred;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .content &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        top: 40px;</span><br><span class="line">        width: 280px;</span><br><span class="line">        left: 60px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .nav &#123;</span><br><span class="line">        font-size: 20px;</span><br><span class="line">        height: 38px;</span><br><span class="line">        border-bottom: 2px solid darkgrey;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .nav &gt; span &#123;</span><br><span class="line">        margin: 0 20px 0 35px;</span><br><span class="line">        color: darkgrey;</span><br><span class="line">        user-select: none;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">        padding-bottom: 10px;</span><br><span class="line">        border-bottom: 2px solid darkgrey;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .nav &gt; span.active &#123;</span><br><span class="line">        color: black;</span><br><span class="line">        border-bottom: 3px solid black;</span><br><span class="line">        padding-bottom: 9px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-input, .el-button &#123;</span><br><span class="line">        margin-top: 40px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-button &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        font-size: 18px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .foot &gt; span &#123;</span><br><span class="line">        float: right;</span><br><span class="line">        margin-top: 20px;</span><br><span class="line">        color: orange;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .sms &#123;</span><br><span class="line">        color: orange;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">        display: inline-block;</span><br><span class="line">        width: 70px;</span><br><span class="line">        text-align: center;</span><br><span class="line">        user-select: none;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<h5 id="Register-vue"><a href="#Register-vue" class="headerlink" title="Register.vue"></a><code>Register.vue</code></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;register&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">            &lt;i class=&quot;el-icon-close&quot; @click=&quot;close_register&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &lt;div class=&quot;content&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;nav&quot;&gt;</span><br><span class="line">                    &lt;span class=&quot;active&quot;&gt;新用户注册&lt;/span&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;el-form&gt;</span><br><span class="line">                    &lt;el-input</span><br><span class="line">                            placeholder=&quot;手机号&quot;</span><br><span class="line">                            prefix-icon=&quot;el-icon-phone-outline&quot;</span><br><span class="line">                            v-model=&quot;mobile&quot;</span><br><span class="line">                            clearable</span><br><span class="line">                            @blur=&quot;check_mobile&quot;&gt;</span><br><span class="line">                    &lt;/el-input&gt;</span><br><span class="line">                    &lt;el-input</span><br><span class="line">                            placeholder=&quot;密码&quot;</span><br><span class="line">                            prefix-icon=&quot;el-icon-key&quot;</span><br><span class="line">                            v-model=&quot;password&quot;</span><br><span class="line">                            clearable</span><br><span class="line">                            show-password&gt;</span><br><span class="line">                    &lt;/el-input&gt;</span><br><span class="line">                    &lt;el-input</span><br><span class="line">                            placeholder=&quot;验证码&quot;</span><br><span class="line">                            prefix-icon=&quot;el-icon-chat-line-round&quot;</span><br><span class="line">                            v-model=&quot;sms&quot;</span><br><span class="line">                            clearable&gt;</span><br><span class="line">                        &lt;template slot=&quot;append&quot;&gt;</span><br><span class="line">                            &lt;span class=&quot;sms&quot; @click=&quot;send_sms&quot;&gt;&#123;&#123; sms_interval &#125;&#125;&lt;/span&gt;</span><br><span class="line">                        &lt;/template&gt;</span><br><span class="line">                    &lt;/el-input&gt;</span><br><span class="line">                    &lt;el-button type=&quot;primary&quot;&gt;注册&lt;/el-button&gt;</span><br><span class="line">                &lt;/el-form&gt;</span><br><span class="line">                &lt;div class=&quot;foot&quot;&gt;</span><br><span class="line">                    &lt;span @click=&quot;go_login&quot;&gt;立即登录&lt;/span&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        name: &quot;Register&quot;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                mobile: &#x27;&#x27;,</span><br><span class="line">                password: &#x27;&#x27;,</span><br><span class="line">                sms: &#x27;&#x27;,</span><br><span class="line">                sms_interval: &#x27;获取验证码&#x27;,</span><br><span class="line">                is_send: false,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            close_register() &#123;</span><br><span class="line">                this.$emit(&#x27;close&#x27;, false)</span><br><span class="line">            &#125;,</span><br><span class="line">            go_login() &#123;</span><br><span class="line">                this.$emit(&#x27;go&#x27;)</span><br><span class="line">            &#125;,</span><br><span class="line">            check_mobile() &#123;</span><br><span class="line">                if (!this.mobile) return;</span><br><span class="line">                if (!this.mobile.match(/^1[3-9][0-9]&#123;9&#125;$/)) &#123;</span><br><span class="line">                    this.$message(&#123;</span><br><span class="line">                        message: &#x27;手机号有误&#x27;,</span><br><span class="line">                        type: &#x27;warning&#x27;,</span><br><span class="line">                        duration: 1000,</span><br><span class="line">                        onClose: () =&gt; &#123;</span><br><span class="line">                            this.mobile = &#x27;&#x27;;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line">                this.is_send = true;</span><br><span class="line">            &#125;,</span><br><span class="line">            send_sms() &#123;</span><br><span class="line">                if (!this.is_send) return;</span><br><span class="line">                this.is_send = false;</span><br><span class="line">                let sms_interval_time = 60;</span><br><span class="line">                this.sms_interval = &quot;发送中...&quot;;</span><br><span class="line">                let timer = setInterval(() =&gt; &#123;</span><br><span class="line">                    if (sms_interval_time &lt;= 1) &#123;</span><br><span class="line">                        clearInterval(timer);</span><br><span class="line">                        this.sms_interval = &quot;获取验证码&quot;;</span><br><span class="line">                        this.is_send = true; // 重新回复点击发送功能的条件</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        sms_interval_time -= 1;</span><br><span class="line">                        this.sms_interval = `$&#123;sms_interval_time&#125;秒后再发`;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, 1000);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">    .register &#123;</span><br><span class="line">        width: 100vw;</span><br><span class="line">        height: 100vh;</span><br><span class="line">        position: fixed;</span><br><span class="line">        top: 0;</span><br><span class="line">        left: 0;</span><br><span class="line">        z-index: 10;</span><br><span class="line">        background-color: rgba(0, 0, 0, 0.3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .box &#123;</span><br><span class="line">        width: 400px;</span><br><span class="line">        height: 480px;</span><br><span class="line">        background-color: white;</span><br><span class="line">        border-radius: 10px;</span><br><span class="line">        position: relative;</span><br><span class="line">        top: calc(50vh - 240px);</span><br><span class="line">        left: calc(50vw - 200px);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-icon-close &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        font-weight: bold;</span><br><span class="line">        font-size: 20px;</span><br><span class="line">        top: 10px;</span><br><span class="line">        right: 10px;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-icon-close:hover &#123;</span><br><span class="line">        color: darkred;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .content &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        top: 40px;</span><br><span class="line">        width: 280px;</span><br><span class="line">        left: 60px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .nav &#123;</span><br><span class="line">        font-size: 20px;</span><br><span class="line">        height: 38px;</span><br><span class="line">        border-bottom: 2px solid darkgrey;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .nav &gt; span &#123;</span><br><span class="line">        margin-left: 90px;</span><br><span class="line">        color: darkgrey;</span><br><span class="line">        user-select: none;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">        padding-bottom: 10px;</span><br><span class="line">        border-bottom: 2px solid darkgrey;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .nav &gt; span.active &#123;</span><br><span class="line">        color: black;</span><br><span class="line">        border-bottom: 3px solid black;</span><br><span class="line">        padding-bottom: 9px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-input, .el-button &#123;</span><br><span class="line">        margin-top: 40px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-button &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        font-size: 18px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .foot &gt; span &#123;</span><br><span class="line">        float: right;</span><br><span class="line">        margin-top: 20px;</span><br><span class="line">        color: orange;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .sms &#123;</span><br><span class="line">        color: orange;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">        display: inline-block;</span><br><span class="line">        width: 70px;</span><br><span class="line">        text-align: center;</span><br><span class="line">        user-select: none;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h5 id="Header-vue"><a href="#Header-vue" class="headerlink" title="Header.vue"></a><code>Header.vue</code></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;slogan&quot;&gt;</span><br><span class="line">      &lt;p&gt;老男孩IT教育 | 帮助有志向的年轻人通过努力学习获得体面的工作和生活&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;nav&quot;&gt;</span><br><span class="line">      &lt;ul class=&quot;left-part&quot;&gt;</span><br><span class="line">        &lt;li class=&quot;logo&quot;&gt;</span><br><span class="line">          &lt;router-link to=&quot;/&quot;&gt;</span><br><span class="line">            &lt;img src=&quot;../assets/img/head-logo.svg&quot; alt=&quot;&quot;&gt;</span><br><span class="line">          &lt;/router-link&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">        &lt;li class=&quot;ele&quot;&gt;</span><br><span class="line">          &lt;span @click=&quot;goPage(&#x27;/free-course&#x27;)&quot; :class=&quot;&#123;active: url_path === &#x27;/free-course&#x27;&#125;&quot;&gt;免费课&lt;/span&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">        &lt;li class=&quot;ele&quot;&gt;</span><br><span class="line">          &lt;span @click=&quot;goPage(&#x27;/actual-course&#x27;)&quot; :class=&quot;&#123;active: url_path === &#x27;/actual-course&#x27;&#125;&quot;&gt;实战课&lt;/span&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">        &lt;li class=&quot;ele&quot;&gt;</span><br><span class="line">          &lt;span @click=&quot;goPage(&#x27;/light-course&#x27;)&quot; :class=&quot;&#123;active: url_path === &#x27;/light-course&#x27;&#125;&quot;&gt;轻课&lt;/span&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;right-part&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;span @click=&quot;put_login&quot;&gt;登录&lt;/span&gt;</span><br><span class="line">          &lt;span class=&quot;line&quot;&gt;|&lt;/span&gt;</span><br><span class="line">          &lt;span @click=&quot;put_register&quot;&gt;注册&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;Login v-if=&quot;is_login&quot; @close=&quot;close_login&quot; @go=&quot;put_register&quot;/&gt;</span><br><span class="line">      &lt;Register v-if=&quot;is_register&quot; @close=&quot;close_register&quot; @go=&quot;put_login&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Login from &quot;@/components/Login&quot;;</span><br><span class="line">import Register from &quot;@/components/Register&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;Header&quot;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      url_path: sessionStorage.url_path || &#x27;/&#x27;,</span><br><span class="line">      is_login: false,</span><br><span class="line">      is_register: false,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    goPage(url_path) &#123;</span><br><span class="line">      // 已经是当前路由就没有必要重新跳转</span><br><span class="line">      if (this.url_path !== url_path) &#123;</span><br><span class="line">        this.$router.push(url_path);</span><br><span class="line">      &#125;</span><br><span class="line">      sessionStorage.url_path = url_path;</span><br><span class="line">    &#125;,</span><br><span class="line">    close_login() &#123;</span><br><span class="line">      this.is_login = false</span><br><span class="line">    &#125;,</span><br><span class="line">    close_register()&#123;</span><br><span class="line">      this.is_register = false</span><br><span class="line">    &#125;,</span><br><span class="line">    put_register()&#123;</span><br><span class="line">      this.is_register = true</span><br><span class="line">      this.is_login = false</span><br><span class="line">    &#125;,</span><br><span class="line">    put_login()&#123;</span><br><span class="line">      this.is_register = false</span><br><span class="line">      this.is_login = true</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    sessionStorage.url_path = this.$route.path;</span><br><span class="line">    this.url_path = this.$route.path;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Login,</span><br><span class="line">    Register,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.header &#123;</span><br><span class="line">  background-color: white;</span><br><span class="line">  box-shadow: 0 0 5px 0 #aaa;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.header:after &#123;</span><br><span class="line">  content: &quot;&quot;;</span><br><span class="line">  display: block;</span><br><span class="line">  clear: both;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.slogan &#123;</span><br><span class="line">  background-color: #eee;</span><br><span class="line">  height: 40px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.slogan p &#123;</span><br><span class="line">  width: 1200px;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line">  color: #aaa;</span><br><span class="line">  font-size: 13px;</span><br><span class="line">  line-height: 40px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav &#123;</span><br><span class="line">  background-color: white;</span><br><span class="line">  user-select: none;</span><br><span class="line">  width: 1200px;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav ul &#123;</span><br><span class="line">  padding: 15px 0;</span><br><span class="line">  float: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav ul:after &#123;</span><br><span class="line">  clear: both;</span><br><span class="line">  content: &#x27;&#x27;;</span><br><span class="line">  display: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav ul li &#123;</span><br><span class="line">  float: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.logo &#123;</span><br><span class="line">  margin-right: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ele &#123;</span><br><span class="line">  margin: 0 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ele span &#123;</span><br><span class="line">  display: block;</span><br><span class="line">  font: 15px/36px &#x27;微软雅黑&#x27;;</span><br><span class="line">  border-bottom: 2px solid transparent;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ele span:hover &#123;</span><br><span class="line">  border-bottom-color: orange;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ele span.active &#123;</span><br><span class="line">  color: orange;</span><br><span class="line">  border-bottom-color: orange;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.right-part &#123;</span><br><span class="line">  float: right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.right-part .line &#123;</span><br><span class="line">  margin: 0 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.right-part span &#123;</span><br><span class="line">  line-height: 68px;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="vue中跳转方式"><a href="#vue中跳转方式" class="headerlink" title="vue中跳转方式"></a>vue中跳转方式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一种</span></span><br><span class="line">this.$router.push(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二种</span></span><br><span class="line">&lt;router-link to=<span class="string">&quot;/login&quot;</span>&gt;&lt;span&gt;登录&lt;/span&gt;&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Banner-vue"><a href="#Banner-vue" class="headerlink" title="Banner.vue"></a><code>Banner.vue</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">// router-link 的使用</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;banner&quot;&gt;</span><br><span class="line">    &lt;el-carousel :interval=&quot;5000&quot; arrow=&quot;always&quot; height=&quot;400px&quot;&gt;</span><br><span class="line">      &lt;el-carousel-item v-for=&quot;item in banner_list&quot; :key=&quot;item.image&quot;&gt;</span><br><span class="line">				&lt;!--可以根据请求的地址判断 进行跳转--&gt;</span><br><span class="line">        &lt;div v-if=&quot;!(item.link.indexOf(&#x27;http&#x27;)&gt;-1)&quot;&gt;</span><br><span class="line">          &lt;router-link :to=&quot;item.link&quot;&gt;</span><br><span class="line">            &lt;img :src=&quot;item.image&quot; alt=&quot;&quot;&gt;</span><br><span class="line">          &lt;/router-link&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div v-else&gt;</span><br><span class="line">          &lt;a :href=&quot;item.link&quot;&gt;</span><br><span class="line">            &lt;img :src=&quot;item.image&quot; alt=&quot;&quot;&gt;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/el-carousel-item&gt;</span><br><span class="line">    &lt;/el-carousel&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;Banner&quot;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      banner_list: [],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.$axios.get(this.$settings.base_url + &#x27;home/banner/&#x27;).then(res =&gt; &#123;</span><br><span class="line">      if (res.data.status == 100) &#123;</span><br><span class="line">        this.banner_list = res.data.data</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">el-carousel-item &#123;</span><br><span class="line">  height: 400px;</span><br><span class="line">  min-width: 1200px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-carousel__item img &#123;</span><br><span class="line">  height: 400px;</span><br><span class="line">  margin-left: calc(50% - 1920px / 2);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="多方式登录功能"><a href="#多方式登录功能" class="headerlink" title="多方式登录功能"></a>多方式登录功能</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">需求: 输入用户名(手机号，邮箱)，密码，都能登陆成功，签发token</span><br><span class="line">例</span><br><span class="line">&#123;</span><br><span class="line">  username:name/130348883775/1233@qq.com,</span><br><span class="line">  password:lqz123</span><br><span class="line">&#125;</span><br><span class="line">到后端去数据库查用户，如果用户名密码正确，签发token，如果不正确，返回错误</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pip install djangorestframework-jwt</span><br></pre></td></tr></table></figure>

<h4 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># luffy_api/apps/user/urls.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"><span class="keyword">from</span> rest_framework.routers <span class="keyword">import</span> SimpleRouter</span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> MobileView, LoginView</span><br><span class="line"></span><br><span class="line">router = SimpleRouter()</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/mobile/check_mobile/  get</span></span><br><span class="line">router.register(<span class="string">&#x27;mobile&#x27;</span>, MobileView, <span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/login/mul_login/  post</span></span><br><span class="line">router.register(<span class="string">&#x27;login&#x27;</span>, LoginView, <span class="string">&#x27;login&#x27;</span>)</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, include(router.urls))</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="序列化类"><a href="#序列化类" class="headerlink" title="序列化类"></a>序列化类</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># luffy_api/apps/user/serializer.py</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> serializers</span><br><span class="line"><span class="keyword">from</span> rest_framework.exceptions <span class="keyword">import</span> ValidationError</span><br><span class="line"><span class="keyword">from</span> rest_framework_jwt.serializers <span class="keyword">import</span> jwt_payload_handler, jwt_encode_handler</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这个序列化类 只做反序列化 数据库校验 不保存 不用序列化</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MulLoginSerializer</span>(<span class="params">serializers.ModelSerializer</span>):</span></span><br><span class="line">    <span class="comment"># 一定要重写 username 字段 校验规则是从User中来 unique</span></span><br><span class="line">    <span class="comment"># 如果存在的用户 再传入该用户 自己的校验规则就会校验失败</span></span><br><span class="line">    username = serializers.CharField(max_length=<span class="number">18</span>, min_length=<span class="number">3</span>)  <span class="comment"># 一定要重写 否则校验不过去</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = User</span><br><span class="line">        fields = [<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;password&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate</span>(<span class="params">self, attrs</span>):</span></span><br><span class="line">        <span class="comment"># 在这完成校验 校验失败抛出异常</span></span><br><span class="line">        <span class="comment"># 1 多方式得到user</span></span><br><span class="line">        user = self._get_user(attrs)</span><br><span class="line">        <span class="comment"># 2  user签发token</span></span><br><span class="line">        token = self._get_token(user)</span><br><span class="line">        <span class="comment"># 3  把token,username,icon放到context中</span></span><br><span class="line">        self.context[<span class="string">&#x27;token&#x27;</span>] = token</span><br><span class="line">        self.context[<span class="string">&#x27;username&#x27;</span>] = user.username</span><br><span class="line">        request = self.context[<span class="string">&#x27;request&#x27;</span>]</span><br><span class="line">        <span class="comment"># request.META[&#x27;HTTP_HOST&#x27;]取出服务端的ip地址</span></span><br><span class="line">        icon = <span class="string">&#x27;http://%s/media/%s&#x27;</span> % (request.META[<span class="string">&#x27;HTTP_HOST&#x27;</span>], <span class="built_in">str</span>(user.icon))</span><br><span class="line">        self.context[<span class="string">&#x27;icon&#x27;</span>] = icon</span><br><span class="line">        <span class="keyword">return</span> attrs</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_user</span>(<span class="params">self, attrs</span>):</span></span><br><span class="line">        username = attrs.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> re.match(<span class="string">r&#x27;^1[3-9][0-9]&#123;9&#125;$&#x27;</span>, username):</span><br><span class="line">            user = User.objects.<span class="built_in">filter</span>(mobile=username).first()</span><br><span class="line">        <span class="keyword">elif</span> re.match(<span class="string">r&#x27;^.+@.+$&#x27;</span>, username):</span><br><span class="line">            user = User.objects.<span class="built_in">filter</span>(email=username).first()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            user = User.objects.<span class="built_in">filter</span>(username=username).first()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> user:</span><br><span class="line">            <span class="keyword">raise</span> ValidationError(<span class="string">&quot;用户名或密码错误&quot;</span>)</span><br><span class="line">        <span class="comment"># 取出前端传入的密码</span></span><br><span class="line">        password = attrs.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> user.check_password(password):</span><br><span class="line">            <span class="keyword">raise</span> ValidationError(<span class="string">&quot;用户名或密码错误&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> user</span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_token</span>(<span class="params">self, user</span>):</span></span><br><span class="line">        payload = jwt_payload_handler(user)</span><br><span class="line">        token = jwt_encode_handler(payload)</span><br><span class="line">        <span class="keyword">return</span> token</span><br></pre></td></tr></table></figure>

<h4 id="视图类"><a href="#视图类" class="headerlink" title="视图类"></a>视图类</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># luffy_api/apps/user/views.py</span></span><br><span class="line"><span class="comment"># luffy_api/media/icon/default.png 该图片要存在</span></span><br><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ViewSet, GenericViewSet</span><br><span class="line"><span class="keyword">from</span> rest_framework.decorators <span class="keyword">import</span> action</span><br><span class="line"><span class="keyword">from</span> rest_framework.exceptions <span class="keyword">import</span> APIException</span><br><span class="line"><span class="keyword">from</span> utils.APIResponse <span class="keyword">import</span> APIResponse</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> .serializer <span class="keyword">import</span> MulLoginSerializer</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MobileView</span>(<span class="params">ViewSet</span>):</span></span><br><span class="line">    <span class="comment"># get 请求携带手机号 校验手机号</span></span><br><span class="line"><span class="meta">    @action(<span class="params">methods=[<span class="string">&#x27;GET&#x27;</span>], detail=<span class="literal">False</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_mobile</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            mobile = request.query_params.get(<span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line">            User.objects.get(mobile=mobile)</span><br><span class="line">            <span class="keyword">return</span> APIResponse()  <span class="comment"># &#123;code: 100, msg: successfully&#125; 前端判断是否 100 即可</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> APIException(<span class="built_in">str</span>(e))  <span class="comment"># 处理了全局异常</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginView</span>(<span class="params">GenericViewSet</span>):</span></span><br><span class="line">    serializer_class = MulLoginSerializer</span><br><span class="line">    queryset = User</span><br><span class="line">    <span class="comment"># 多方式登录</span></span><br><span class="line">    <span class="comment"># login 不是保存 但是用 post 把验证逻辑写到序列化类中</span></span><br><span class="line"><span class="meta">    @action(<span class="params">methods=[<span class="string">&#x27;POST&#x27;</span>], detail=<span class="literal">False</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mul_login</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            ser = MulLoginSerializer(data=request.data, context=&#123;<span class="string">&#x27;request&#x27;</span>: request&#125;)</span><br><span class="line">            ser.is_valid(raise_exception=<span class="literal">True</span>)  <span class="comment"># 如果校验失败 直接抛出异常 不用if判断</span></span><br><span class="line">            token = ser.context.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">            username = ser.context.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">            icon = ser.context.get(<span class="string">&#x27;icon&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> APIResponse(data=&#123;<span class="string">&#x27;token&#x27;</span>: token, <span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;icon&#x27;</span>: icon&#125;)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> APIException(<span class="built_in">str</span>(e))</span><br></pre></td></tr></table></figure>

<h3 id="二次封装腾讯云短信发送"><a href="#二次封装腾讯云短信发送" class="headerlink" title="二次封装腾讯云短信发送"></a>二次封装腾讯云短信发送</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将腾讯云提供的SDK二次封装为一个包</span></span><br><span class="line"><span class="comment"># 创建 luffy_api/libs/tencent_sms_v3 文件夹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># settings.py</span></span><br><span class="line">SECRETID = <span class="string">&quot;&quot;</span></span><br><span class="line">SECRETKEY = <span class="string">&quot;&quot;</span></span><br><span class="line">APPID = <span class="string">&quot;&quot;</span></span><br><span class="line">SIGNNAME = <span class="string">&quot;&quot;</span></span><br><span class="line">TEMPLATEID = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sms.py</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common <span class="keyword">import</span> credential</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common.exception.tencent_cloud_sdk_exception <span class="keyword">import</span> TencentCloudSDKException</span><br><span class="line"><span class="keyword">from</span> tencentcloud.sms.v20210111 <span class="keyword">import</span> sms_client, models</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common.profile.client_profile <span class="keyword">import</span> ClientProfile</span><br><span class="line"><span class="keyword">from</span> tencentcloud.common.profile.http_profile <span class="keyword">import</span> HttpProfile</span><br><span class="line"><span class="keyword">from</span> utils.luffy_logging <span class="keyword">import</span> logger</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_code</span>(<span class="params">count=<span class="number">4</span></span>):</span></span><br><span class="line">    code_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">        num = random.randint(<span class="number">0</span>, <span class="number">9</span>)</span><br><span class="line">        code_str += <span class="built_in">str</span>(num)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> code_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_sms</span>(<span class="params">phone, code</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cred = credential.Credential(settings.SECRETID, settings.SECRETKEY)</span><br><span class="line">        httpProfile = HttpProfile()</span><br><span class="line"></span><br><span class="line">        httpProfile.reqMethod = <span class="string">&quot;POST&quot;</span>  <span class="comment"># post请求(默认为post请求)</span></span><br><span class="line">        httpProfile.reqTimeout = <span class="number">30</span>  <span class="comment"># 请求超时时间，单位为秒(默认60秒)</span></span><br><span class="line">        httpProfile.endpoint = <span class="string">&quot;sms.tencentcloudapi.com&quot;</span>  <span class="comment"># 指定接入地域域名(默认就近接入)</span></span><br><span class="line">        clientProfile = ClientProfile()</span><br><span class="line">        clientProfile.signMethod = <span class="string">&quot;TC3-HMAC-SHA256&quot;</span>  <span class="comment"># 指定签名算法</span></span><br><span class="line">        clientProfile.language = <span class="string">&quot;en-US&quot;</span></span><br><span class="line">        clientProfile.httpProfile = httpProfile</span><br><span class="line">        client = sms_client.SmsClient(cred, <span class="string">&quot;ap-guangzhou&quot;</span>, clientProfile)</span><br><span class="line">        req = models.SendSmsRequest()</span><br><span class="line">        req.SmsSdkAppId = settings.APPID</span><br><span class="line">        req.SignName = settings.SIGNNAME</span><br><span class="line">        req.TemplateId = settings.TEMPLATEID</span><br><span class="line">        req.TemplateParamSet = [code, <span class="string">&quot;5&quot;</span>]</span><br><span class="line">        req.PhoneNumberSet = [<span class="string">&quot;+86%s&quot;</span> % phone, ]</span><br><span class="line">        req.SessionContext = <span class="string">&quot;&quot;</span></span><br><span class="line">        req.ExtendCode = <span class="string">&quot;&quot;</span></span><br><span class="line">        req.SenderId = <span class="string">&quot;&quot;</span></span><br><span class="line">        client.SendSms(req)</span><br><span class="line">        <span class="comment"># print(resp.to_json_string(indent=2))</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> TencentCloudSDKException <span class="keyword">as</span> err:</span><br><span class="line">        <span class="comment"># 如果短信发送失败 记录日志 如果给别人使用 需要修改</span></span><br><span class="line">        logger.error(<span class="string">&quot;手机号为: %s 发送短信失败，失败原因: %s&quot;</span> %(phone,<span class="built_in">str</span>(err)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(get_code())</span><br><span class="line"></span><br><span class="line"><span class="comment"># __init__.py</span></span><br><span class="line"><span class="keyword">from</span> .sms <span class="keyword">import</span> get_code, send_sms</span><br></pre></td></tr></table></figure>

<h3 id="发送短信接口"><a href="#发送短信接口" class="headerlink" title="发送短信接口"></a>发送短信接口</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">get 请求 携带手机号就发送短信  ?phnoe=phone</span><br><span class="line">验证码保存在缓存中</span><br><span class="line">缓存：是一个存数据的地方，可以存，可以取（缓存可以缓存到的位置有很多，内存，文件，redis，mysql）</span><br><span class="line">django内置了一个缓存功能 导入使用即可</span><br><span class="line"><span class="keyword">from</span> django.core.cache <span class="keyword">import</span> cache</span><br><span class="line">cache.<span class="built_in">set</span>(<span class="string">&#x27;sms_cache_%s&#x27;</span>%phone,code) <span class="comment"># 设置值，key value形式，key应该唯一，使用手机号</span></span><br><span class="line">cache.get() <span class="comment"># 取值，根据key取</span></span><br></pre></td></tr></table></figure>

<h4 id="路由-1"><a href="#路由-1" class="headerlink" title="路由"></a>路由</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># luffy_api/apps/user/urls.py</span></span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"><span class="keyword">from</span> rest_framework.routers <span class="keyword">import</span> SimpleRouter</span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> MobileView, LoginView,SendSmsView</span><br><span class="line"></span><br><span class="line">router = SimpleRouter()</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/mobile/check_mobile/  get</span></span><br><span class="line">router.register(<span class="string">&#x27;mobile&#x27;</span>, MobileView, <span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/login/mul_login/  post</span></span><br><span class="line">router.register(<span class="string">&#x27;login&#x27;</span>, LoginView, <span class="string">&#x27;login&#x27;</span>)</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/send/send_message/  get</span></span><br><span class="line">router.register(<span class="string">&#x27;send&#x27;</span>, SendSmsView, <span class="string">&#x27;send&#x27;</span>)</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, include(router.urls))</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># luffy_api/apps/user/views.py 添加代码</span></span><br><span class="line"><span class="keyword">from</span> libs <span class="keyword">import</span> tencent_sms_v3</span><br><span class="line"><span class="keyword">from</span> django.core.cache <span class="keyword">import</span> cache</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendSmsView</span>(<span class="params">ViewSet</span>):</span></span><br><span class="line"><span class="meta">    @action(<span class="params">methods=[<span class="string">&quot;GET&quot;</span>],detail=<span class="literal">False</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send_message</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            phone = request.query_params.get(<span class="string">&#x27;phone&#x27;</span>)</span><br><span class="line">            code = tencent_sms_v3.get_code()</span><br><span class="line">            <span class="comment"># 保存验证码到缓存中 cache 第三个参数超时时间</span></span><br><span class="line">            cache.<span class="built_in">set</span>(<span class="string">&quot;sms_cache_%s&quot;</span> % phone, code, <span class="number">300</span>)</span><br><span class="line">            res = tencent_sms_v3.send_sms(phone, code)</span><br><span class="line">            <span class="keyword">if</span> res:</span><br><span class="line">                <span class="keyword">return</span> APIResponse(data=<span class="string">&quot;短信发送成功&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> APIException(<span class="built_in">str</span>(e))</span><br></pre></td></tr></table></figure>

<h3 id="短信登录接口"><a href="#短信登录接口" class="headerlink" title="短信登录接口"></a>短信登录接口</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">根据原型图(页面) ---&gt; 该接口需要两个参数</span><br><span class="line">&#123;mobile:130xxxx,code:8888&#125;</span><br><span class="line"></span><br><span class="line">post:</span><br><span class="line">127.0.0.1:8000/api/v1/user/login/sms_login/</span><br></pre></td></tr></table></figure>

<h4 id="视图类-1"><a href="#视图类-1" class="headerlink" title="视图类"></a>视图类</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 多方式登录接口</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginView</span>(<span class="params">GenericViewSet</span>):</span></span><br><span class="line">    serializer_class = MulLoginSerializer</span><br><span class="line">    queryset = User</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 多方式登录</span></span><br><span class="line">    <span class="comment"># login 不是保存 但是用 post 把验证逻辑写到序列化类中</span></span><br><span class="line"><span class="meta">    @action(<span class="params">methods=[<span class="string">&#x27;POST&#x27;</span>], detail=<span class="literal">False</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mul_login</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._common_login(request)</span><br><span class="line">      </span><br><span class="line">		<span class="comment"># 验证码登录</span></span><br><span class="line"><span class="meta">    @action(<span class="params">methods=[<span class="string">&#x27;POST&#x27;</span>], detail=<span class="literal">False</span></span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sms_login</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._common_login(request)</span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_common_login</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            ser = self.get_serializer(data=request.data, context=&#123;<span class="string">&#x27;request&#x27;</span>: request&#125;)</span><br><span class="line">            ser.is_valid(raise_exception=<span class="literal">True</span>)  <span class="comment"># 如果校验失败 直接抛出异常 不用if判断</span></span><br><span class="line">            token = ser.context.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">            username = ser.context.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">            icon = ser.context.get(<span class="string">&#x27;icon&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> APIResponse(data=&#123;<span class="string">&#x27;token&#x27;</span>: token, <span class="string">&#x27;username&#x27;</span>: username, <span class="string">&#x27;icon&#x27;</span>: icon&#125;)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> APIException(<span class="built_in">str</span>(e))</span><br><span class="line">            </span><br><span class="line">    <span class="comment"># 根据请求判断取出不同的序列化类</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_serializer_class</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.action == <span class="string">&#x27;mul_login&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> self.serializer_class</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> SmsLoginSerializer</span><br></pre></td></tr></table></figure>

<h4 id="序列化类-1"><a href="#序列化类-1" class="headerlink" title="序列化类"></a>序列化类</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core.cache <span class="keyword">import</span> cache</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SmsLoginSerializer</span>(<span class="params">serializers.ModelSerializer</span>):</span></span><br><span class="line">    code = serializers.CharField(max_length=<span class="number">4</span>, min_length=<span class="number">4</span>)</span><br><span class="line">    mobile = serializers.CharField(max_length=<span class="number">11</span>, min_length=<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = User</span><br><span class="line">        fields = [<span class="string">&#x27;mobile&#x27;</span>, <span class="string">&#x27;code&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate</span>(<span class="params">self, attrs</span>):</span></span><br><span class="line">        self._check_code(attrs)</span><br><span class="line">        user = self._get_user(attrs)</span><br><span class="line">        token = self._get_token(user)</span><br><span class="line">        self.context[<span class="string">&#x27;token&#x27;</span>] = token</span><br><span class="line">        self.context[<span class="string">&#x27;username&#x27;</span>] = user.username</span><br><span class="line">        request = self.context[<span class="string">&#x27;request&#x27;</span>]</span><br><span class="line">        icon = <span class="string">&#x27;http://%s/media/%s&#x27;</span> % (request.META[<span class="string">&#x27;HTTP_HOST&#x27;</span>], <span class="built_in">str</span>(user.icon))</span><br><span class="line">        self.context[<span class="string">&#x27;icon&#x27;</span>] = icon</span><br><span class="line">        <span class="keyword">return</span> attrs</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_code</span>(<span class="params">self, attrs</span>):</span></span><br><span class="line">        mobile = attrs.get(<span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line">        new_code = attrs.get(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> mobile:</span><br><span class="line">            old_code = cache.get(<span class="string">&quot;sms_cache_%s&quot;</span> % mobile)</span><br><span class="line">            <span class="keyword">if</span> old_code != new_code:</span><br><span class="line">                <span class="keyword">raise</span> ValidationError(<span class="string">&#x27;验证码错误&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValidationError(<span class="string">&#x27;没带手机号&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> attrs</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_user</span>(<span class="params">self, attrs</span>):</span></span><br><span class="line">        mobile = attrs.get(<span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> User.objects.get(mobile=mobile)  <span class="comment"># 捕获了全局异常 get出错了也能捕获</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_token</span>(<span class="params">self, user</span>):</span></span><br><span class="line">        payload = jwt_payload_handler(user)</span><br><span class="line">        token = jwt_encode_handler(payload)</span><br><span class="line">        <span class="keyword">return</span> token</span><br></pre></td></tr></table></figure>



<h3 id="短信注册接口"><a href="#短信注册接口" class="headerlink" title="短信注册接口"></a>短信注册接口</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;mobile:1234444,code:8888,password:123456&#125; ---&gt; 创建一个新用户</span><br></pre></td></tr></table></figure>

<h4 id="路由-2"><a href="#路由-2" class="headerlink" title="路由"></a>路由</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"><span class="keyword">from</span> rest_framework.routers <span class="keyword">import</span> SimpleRouter</span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> MobileView, LoginView, SendSmsView, RegisterView</span><br><span class="line"></span><br><span class="line">router = SimpleRouter()</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/mobile/check_mobile/  get</span></span><br><span class="line">router.register(<span class="string">&#x27;mobile&#x27;</span>, MobileView, <span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/login/mul_login/  post</span></span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/login/sms_login/  post</span></span><br><span class="line">router.register(<span class="string">&#x27;login&#x27;</span>, LoginView, <span class="string">&#x27;login&#x27;</span>)</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/send/send_message/  get</span></span><br><span class="line">router.register(<span class="string">&#x27;send&#x27;</span>, SendSmsView, <span class="string">&#x27;send&#x27;</span>)</span><br><span class="line"><span class="comment"># 127.0.0.1:8000/api/v1/user/register/  post</span></span><br><span class="line">router.register(<span class="string">&#x27;register&#x27;</span>, RegisterView, <span class="string">&#x27;register&#x27;</span>)</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, include(router.urls))</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="视图类-2"><a href="#视图类-2" class="headerlink" title="视图类"></a>视图类</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core.cache <span class="keyword">import</span> cache</span><br><span class="line"><span class="keyword">from</span> rest_framework.viewsets <span class="keyword">import</span> ViewSet, GenericViewSet</span><br><span class="line"><span class="keyword">from</span> rest_framework.mixins <span class="keyword">import</span> CreateModelMixin</span><br><span class="line"><span class="keyword">from</span> rest_framework.decorators <span class="keyword">import</span> action</span><br><span class="line"><span class="keyword">from</span> rest_framework.exceptions <span class="keyword">import</span> APIException</span><br><span class="line"><span class="keyword">from</span> utils.APIResponse <span class="keyword">import</span> APIResponse</span><br><span class="line"><span class="keyword">from</span> libs <span class="keyword">import</span> tencent_sms_v3</span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> .serializer <span class="keyword">import</span> MulLoginSerializer, SmsLoginSerializer,RegisterSerializer</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegisterView</span>(<span class="params">GenericViewSet, CreateModelMixin</span>):</span></span><br><span class="line">    serializer_class = RegisterSerializer</span><br><span class="line">    queryset = User.objects.<span class="built_in">all</span>()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">self, request, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().create(request, *args, **kwargs)</span><br><span class="line">        <span class="keyword">return</span> APIResponse(data=<span class="string">&quot;注册成功&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="序列化类-2"><a href="#序列化类-2" class="headerlink" title="序列化类"></a>序列化类</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegisterSerializer</span>(<span class="params">serializers.ModelSerializer</span>):</span></span><br><span class="line">    <span class="comment"># code 不在数据库中 需要重写 只写 读不了数据库</span></span><br><span class="line">    code = serializers.CharField(max_length=<span class="number">4</span>, min_length=<span class="number">4</span>, write_only=<span class="literal">True</span>)  </span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = User</span><br><span class="line">        fields = [<span class="string">&#x27;mobile&#x27;</span>, <span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        extra_kwargs = &#123;</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: &#123;<span class="string">&#x27;write_only&#x27;</span>: <span class="literal">True</span>&#125;,  <span class="comment"># 不需要给前端</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># 局部钩子 校验手机号是否合法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate_mobile</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> re.match(<span class="string">r&#x27;^1[3-9][0-9]&#123;9&#125;$&#x27;</span>, value):</span><br><span class="line">            <span class="keyword">raise</span> ValidationError(<span class="string">&#x27;手机号不合法&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">      </span><br><span class="line">    <span class="comment"># 全局钩子</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate</span>(<span class="params">self, attrs</span>):</span></span><br><span class="line">        <span class="comment"># 校验验证码</span></span><br><span class="line">        self._check_code(attrs)</span><br><span class="line">        <span class="comment"># 数据清理</span></span><br><span class="line">        self._per_save(attrs)</span><br><span class="line">        <span class="keyword">return</span> attrs</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_code</span>(<span class="params">self, attrs</span>):</span></span><br><span class="line">        <span class="comment"># 校验code</span></span><br><span class="line">        new_code = attrs.get(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">        mobile = attrs.get(<span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line">        old_code = cache.get(<span class="string">&quot;sms_cache_%s&quot;</span> % mobile)</span><br><span class="line">        <span class="keyword">if</span> new_code != old_code:</span><br><span class="line">            <span class="keyword">raise</span> ValidationError(<span class="string">&#x27;验证码错误&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> attrs</span><br><span class="line">      </span><br><span class="line">    <span class="comment"># 存入数据之前将code剔除 并设置用户名</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_per_save</span>(<span class="params">self, attrs</span>):</span></span><br><span class="line">        attrs.pop(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">        attrs[<span class="string">&#x27;username&#x27;</span>] = attrs.get(<span class="string">&#x27;mobile&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> attrs</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建用户</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">self, validated_data</span>):</span></span><br><span class="line">        <span class="comment"># auth 组件 创建用户</span></span><br><span class="line">        user = User.objects.create_user(**validated_data)</span><br><span class="line">        <span class="keyword">return</span> user</span><br></pre></td></tr></table></figure>

<h3 id="登录注册前端页面"><a href="#登录注册前端页面" class="headerlink" title="登录注册前端页面"></a>登录注册前端页面</h3><h4 id="前端存入数据"><a href="#前端存入数据" class="headerlink" title="前端存入数据"></a>前端存入数据</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 存到 cookie 中，js 操作，在 vue 中可以借助 vue-cookies 第三方插件</span><br><span class="line">   npm install vue-cookies -S</span><br><span class="line">   导入: src/main.js</span><br><span class="line">      <span class="keyword">import</span> cookies <span class="keyword">from</span> <span class="string">&#x27;vue-cookies&#x27;</span></span><br><span class="line">      Vue.prototype.$cookies = cookies;</span><br><span class="line">   使用:</span><br><span class="line">      this.$cookies.<span class="built_in">set</span>()</span><br><span class="line">      this.$cookies.get()</span><br><span class="line">      </span><br><span class="line"><span class="number">2.</span> localStorage 永久存储</span><br><span class="line">     localStorage.setItem(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>);</span><br><span class="line">     localStorage.key = <span class="string">&quot;value&quot;</span></span><br><span class="line">     localStorage[<span class="string">&quot;key&quot;</span>] = <span class="string">&quot;value&quot;</span></span><br><span class="line">      </span><br><span class="line"><span class="number">3.</span> sessionStorage 临时存储，关闭浏览器丢失</span><br><span class="line">     sessionStorage.setItem(<span class="string">&quot;age&quot;</span>,<span class="string">&#x27;19&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://klcc-img-1251900471.cos.ap-chengdu.myqcloud.com/img/image-20220425214754903.png" alt="image-20220425214754903"></p>
<h4 id="Header-vue-1"><a href="#Header-vue-1" class="headerlink" title="Header.vue"></a><code>Header.vue</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;slogan&quot;&gt;</span><br><span class="line">      &lt;p&gt;老男孩IT教育 | 帮助有志向的年轻人通过努力学习获得体面的工作和生活&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;nav&quot;&gt;</span><br><span class="line">      &lt;ul class=&quot;left-part&quot;&gt;</span><br><span class="line">        &lt;li class=&quot;logo&quot;&gt;</span><br><span class="line">          &lt;router-link to=&quot;/&quot;&gt;</span><br><span class="line">            &lt;img src=&quot;../assets/img/head-logo.svg&quot; alt=&quot;&quot;&gt;</span><br><span class="line">          &lt;/router-link&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">        &lt;li class=&quot;ele&quot;&gt;</span><br><span class="line">          &lt;span @click=&quot;goPage(&#x27;/free-course&#x27;)&quot; :class=&quot;&#123;active: url_path === &#x27;/free-course&#x27;&#125;&quot;&gt;免费课&lt;/span&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">        &lt;li class=&quot;ele&quot;&gt;</span><br><span class="line">          &lt;span @click=&quot;goPage(&#x27;/actual-course&#x27;)&quot; :class=&quot;&#123;active: url_path === &#x27;/actual-course&#x27;&#125;&quot;&gt;实战课&lt;/span&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">        &lt;li class=&quot;ele&quot;&gt;</span><br><span class="line">          &lt;span @click=&quot;goPage(&#x27;/light-course&#x27;)&quot; :class=&quot;&#123;active: url_path === &#x27;/light-course&#x27;&#125;&quot;&gt;轻课&lt;/span&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">      &lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;right-part&quot;&gt;</span><br><span class="line">        &lt;div v-if=&quot;username&quot;&gt;</span><br><span class="line">          &lt;span style=&quot;margin-right: 10px&quot;&gt;&lt;img :src=&quot;icon&quot; alt=&quot;&quot; width=&quot;25px&quot;&gt;&lt;/span&gt;</span><br><span class="line">          &lt;span&gt;&#123;&#123; username &#125;&#125;&lt;/span&gt;</span><br><span class="line">          &lt;span class=&quot;line&quot;&gt;|&lt;/span&gt;</span><br><span class="line">          &lt;span @click=&quot;handleLogout&quot;&gt;退出&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div v-else&gt;</span><br><span class="line">          &lt;span @click=&quot;put_login&quot;&gt;登录&lt;/span&gt;</span><br><span class="line">          &lt;span class=&quot;line&quot;&gt;|&lt;/span&gt;</span><br><span class="line">          &lt;span @click=&quot;put_register&quot;&gt;注册&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;Login v-if=&quot;is_login&quot; @close=&quot;close_login&quot; @go=&quot;put_register&quot;/&gt;</span><br><span class="line">      &lt;Register v-if=&quot;is_register&quot; @close=&quot;close_register&quot; @go=&quot;put_login&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Login from &quot;@/components/Login&quot;;</span><br><span class="line">import Register from &quot;@/components/Register&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;Header&quot;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      url_path: sessionStorage.url_path || &#x27;/&#x27;,</span><br><span class="line">      is_login: false,</span><br><span class="line">      is_register: false,</span><br><span class="line">      username: &#x27;&#x27;,</span><br><span class="line">      icon: &#x27;&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    goPage(url_path) &#123;</span><br><span class="line">      // 已经是当前路由就没有必要重新跳转</span><br><span class="line">      if (this.url_path !== url_path) &#123;</span><br><span class="line">        this.$router.push(url_path);</span><br><span class="line">      &#125;</span><br><span class="line">      sessionStorage.url_path = url_path;</span><br><span class="line">    &#125;,</span><br><span class="line">    close_login() &#123;</span><br><span class="line">      this.is_login = false</span><br><span class="line">      // 登录了，从 cookie 中取出 username icon</span><br><span class="line">      this.username = this.$cookies.get(&#x27;username&#x27;)</span><br><span class="line">      this.icon = this.$cookies.get(&#x27;icon&#x27;)</span><br><span class="line">    &#125;,</span><br><span class="line">    close_register() &#123;</span><br><span class="line">      this.is_register = false</span><br><span class="line">    &#125;,</span><br><span class="line">    put_register() &#123;</span><br><span class="line">      this.is_register = true</span><br><span class="line">      this.is_login = false</span><br><span class="line">    &#125;,</span><br><span class="line">    put_login() &#123;</span><br><span class="line">      this.is_register = false</span><br><span class="line">      this.is_login = true</span><br><span class="line">    &#125;,</span><br><span class="line">    handleLogout()&#123;</span><br><span class="line">      // 删除cookie 退出</span><br><span class="line">      this.$cookies.set(&#x27;username&#x27;,&#x27;&#x27;)</span><br><span class="line">      this.$cookies.set(&#x27;token&#x27;,&#x27;&#x27;)</span><br><span class="line">      this.$cookies.set(&#x27;icon&#x27;,&#x27;&#x27;)</span><br><span class="line">      this.username = &#x27;&#x27;</span><br><span class="line">      this.icon = &#x27;&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    sessionStorage.url_path = this.$route.path;</span><br><span class="line">    this.url_path = this.$route.path;</span><br><span class="line">    this.username = this.$cookies.get(&#x27;username&#x27;)</span><br><span class="line">    this.icon = this.$cookies.get(&#x27;icon&#x27;)</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Login,</span><br><span class="line">    Register,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.header &#123;</span><br><span class="line">  background-color: white;</span><br><span class="line">  box-shadow: 0 0 5px 0 #aaa;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.header:after &#123;</span><br><span class="line">  content: &quot;&quot;;</span><br><span class="line">  display: block;</span><br><span class="line">  clear: both;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.slogan &#123;</span><br><span class="line">  background-color: #eee;</span><br><span class="line">  height: 40px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.slogan p &#123;</span><br><span class="line">  width: 1200px;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line">  color: #aaa;</span><br><span class="line">  font-size: 13px;</span><br><span class="line">  line-height: 40px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav &#123;</span><br><span class="line">  background-color: white;</span><br><span class="line">  user-select: none;</span><br><span class="line">  width: 1200px;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav ul &#123;</span><br><span class="line">  padding: 15px 0;</span><br><span class="line">  float: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav ul:after &#123;</span><br><span class="line">  clear: both;</span><br><span class="line">  content: &#x27;&#x27;;</span><br><span class="line">  display: block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav ul li &#123;</span><br><span class="line">  float: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.logo &#123;</span><br><span class="line">  margin-right: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ele &#123;</span><br><span class="line">  margin: 0 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ele span &#123;</span><br><span class="line">  display: block;</span><br><span class="line">  font: 15px/36px &#x27;微软雅黑&#x27;;</span><br><span class="line">  border-bottom: 2px solid transparent;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ele span:hover &#123;</span><br><span class="line">  border-bottom-color: orange;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ele span.active &#123;</span><br><span class="line">  color: orange;</span><br><span class="line">  border-bottom-color: orange;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.right-part &#123;</span><br><span class="line">  float: right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.right-part .line &#123;</span><br><span class="line">  margin: 0 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.right-part span &#123;</span><br><span class="line">  line-height: 68px;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Login-vue-1"><a href="#Login-vue-1" class="headerlink" title="Login.vue"></a><code>Login.vue</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;login&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-close&quot; @click=&quot;close_login&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;div class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;nav&quot;&gt;</span><br><span class="line">                    &lt;span :class=&quot;&#123;active: login_method === &#x27;is_pwd&#x27;&#125;&quot;</span><br><span class="line">                          @click=&quot;change_login_method(&#x27;is_pwd&#x27;)&quot;&gt;密码登录&lt;/span&gt;</span><br><span class="line">          &lt;span :class=&quot;&#123;active: login_method === &#x27;is_sms&#x27;&#125;&quot;</span><br><span class="line">                @click=&quot;change_login_method(&#x27;is_sms&#x27;)&quot;&gt;短信登录&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;el-form v-if=&quot;login_method === &#x27;is_pwd&#x27;&quot;&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">              placeholder=&quot;用户名/手机号/邮箱&quot;</span><br><span class="line">              prefix-icon=&quot;el-icon-user&quot;</span><br><span class="line">              v-model=&quot;username&quot;</span><br><span class="line">              clearable&gt;</span><br><span class="line">          &lt;/el-input&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">              placeholder=&quot;密码&quot;</span><br><span class="line">              prefix-icon=&quot;el-icon-key&quot;</span><br><span class="line">              v-model=&quot;password&quot;</span><br><span class="line">              clearable</span><br><span class="line">              show-password&gt;</span><br><span class="line">          &lt;/el-input&gt;</span><br><span class="line">          &lt;el-button type=&quot;primary&quot; @click=&quot;handlePasswordLogin&quot;&gt;登录&lt;/el-button&gt;</span><br><span class="line">        &lt;/el-form&gt;</span><br><span class="line">        &lt;el-form v-if=&quot;login_method === &#x27;is_sms&#x27;&quot;&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">              placeholder=&quot;手机号&quot;</span><br><span class="line">              prefix-icon=&quot;el-icon-phone-outline&quot;</span><br><span class="line">              v-model=&quot;mobile&quot;</span><br><span class="line">              clearable</span><br><span class="line">              @blur=&quot;check_mobile&quot;&gt;</span><br><span class="line">          &lt;/el-input&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">              placeholder=&quot;验证码&quot;</span><br><span class="line">              prefix-icon=&quot;el-icon-chat-line-round&quot;</span><br><span class="line">              v-model=&quot;sms&quot;</span><br><span class="line">              clearable&gt;</span><br><span class="line">            &lt;template slot=&quot;append&quot;&gt;</span><br><span class="line">              &lt;span class=&quot;sms&quot; @click=&quot;send_sms&quot;&gt;&#123;&#123; sms_interval &#125;&#125;&lt;/span&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">          &lt;/el-input&gt;</span><br><span class="line">          &lt;el-button type=&quot;primary&quot; @click=&quot;handleMobileLogin&quot;&gt;登录&lt;/el-button&gt;</span><br><span class="line">        &lt;/el-form&gt;</span><br><span class="line">        &lt;div class=&quot;foot&quot;&gt;</span><br><span class="line">          &lt;span @click=&quot;go_register&quot;&gt;立即注册&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;Login&quot;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      username: &#x27;&#x27;,</span><br><span class="line">      password: &#x27;&#x27;,</span><br><span class="line">      mobile: &#x27;&#x27;,</span><br><span class="line">      sms: &#x27;&#x27;,</span><br><span class="line">      login_method: &#x27;is_pwd&#x27;,</span><br><span class="line">      sms_interval: &#x27;获取验证码&#x27;,</span><br><span class="line">      is_send: false,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    close_login() &#123;</span><br><span class="line">      this.$emit(&#x27;close&#x27;)</span><br><span class="line">    &#125;,</span><br><span class="line">    go_register() &#123;</span><br><span class="line">      this.$emit(&#x27;go&#x27;)</span><br><span class="line">    &#125;,</span><br><span class="line">    change_login_method(method) &#123;</span><br><span class="line">      this.login_method = method;</span><br><span class="line">    &#125;,</span><br><span class="line">    check_mobile() &#123;</span><br><span class="line">      if (!this.mobile) return;</span><br><span class="line">      if (!this.mobile.match(/^1[3-9][0-9]&#123;9&#125;$/)) &#123;</span><br><span class="line">        this.$message(&#123;</span><br><span class="line">          message: &#x27;手机号有误&#x27;,</span><br><span class="line">          type: &#x27;warning&#x27;,</span><br><span class="line">          duration: 1000,</span><br><span class="line">          onClose: () =&gt; &#123;</span><br><span class="line">            this.mobile = &#x27;&#x27;;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        return false;</span><br><span class="line">      &#125;</span><br><span class="line">      this.is_send = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    send_sms() &#123;</span><br><span class="line">      if (!this.is_send) return;</span><br><span class="line">      this.is_send = false;</span><br><span class="line">      let sms_interval_time = 60;</span><br><span class="line">      this.sms_interval = &quot;发送中...&quot;;</span><br><span class="line">      let timer = setInterval(() =&gt; &#123;</span><br><span class="line">        if (sms_interval_time &lt;= 1) &#123;</span><br><span class="line">          clearInterval(timer);</span><br><span class="line">          this.sms_interval = &quot;获取验证码&quot;;</span><br><span class="line">          this.is_send = true; // 重新回复点击发送功能的条件</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          sms_interval_time -= 1;</span><br><span class="line">          this.sms_interval = `$&#123;sms_interval_time&#125;秒后再发`;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, 1000);</span><br><span class="line">      // 发送短信验证码</span><br><span class="line">      this.$axios.get(this.$settings.base_url + &#x27;user/send/send_message/?phone=&#x27; + this.mobile).then(</span><br><span class="line">          res =&gt; &#123;</span><br><span class="line">            if (res.data.status == 100) &#123;</span><br><span class="line">              this.$message(&#123;</span><br><span class="line">                message: &#x27;验证码发送成功&#x27;,</span><br><span class="line">                type: &#x27;success&#x27;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">              this.$message(&#123;</span><br><span class="line">                message: &#x27;验证码发送失败，请稍后再试&#x27;,</span><br><span class="line">                type: &#x27;warning&#x27;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      )</span><br><span class="line">    &#125;,</span><br><span class="line">    handlePasswordLogin() &#123;</span><br><span class="line">      // 用户名和密码是否填入</span><br><span class="line">      if (this.username &amp;&amp; this.password) &#123;</span><br><span class="line">        // 向后端请求</span><br><span class="line">        this.$axios.post(this.$settings.base_url + &#x27;user/login/mul_login/&#x27;,</span><br><span class="line">            &#123;</span><br><span class="line">              username: this.username,</span><br><span class="line">              password: this.password,</span><br><span class="line">            &#125;).then(res =&gt; &#123;</span><br><span class="line">          if (res.data.status == 100) &#123;</span><br><span class="line">            console.log(res.data)</span><br><span class="line"></span><br><span class="line">            // 1. 把 token 和 username 存到 cookie 中</span><br><span class="line">            this.$cookies.set(&#x27;username&#x27;, res.data.data.username,&#x27;7d&#x27;)</span><br><span class="line">            this.$cookies.set(&#x27;token&#x27;, res.data.data.token,&#x27;7d&#x27;)</span><br><span class="line">            this.$cookies.set(&#x27;icon&#x27;, res.data.data.icon,&#x27;7d&#x27;)</span><br><span class="line">            this.$message(&#123;</span><br><span class="line">              message: &#x27;恭喜你，登录成功&#x27;,</span><br><span class="line">              type: &#x27;success&#x27;</span><br><span class="line">            &#125;);</span><br><span class="line">            // 2. 关闭登录框</span><br><span class="line">            this.close_login()</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            this.$message.error(res.data.msg)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.$message.error(&#x27;用户名和密码必填&#x27;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleMobileLogin() &#123;</span><br><span class="line">      if (this.mobile &amp;&amp; this.sms) &#123;</span><br><span class="line">        // 向后端请求</span><br><span class="line">        this.$axios.post(this.$settings.base_url + &#x27;user/login/sms_login/&#x27;,</span><br><span class="line">            &#123;</span><br><span class="line">              mobile: this.mobile,</span><br><span class="line">              code: this.sms,</span><br><span class="line">            &#125;).then(res =&gt; &#123;</span><br><span class="line">          if (res.data.status == 100) &#123;</span><br><span class="line">            console.log(res.data)</span><br><span class="line"></span><br><span class="line">            // 1. 把 token 和 username 存到 cookie 中</span><br><span class="line">            this.$cookies.set(&#x27;username&#x27;, res.data.data.username)</span><br><span class="line">            this.$cookies.set(&#x27;token&#x27;, res.data.data.token)</span><br><span class="line">            this.$cookies.set(&#x27;icon&#x27;, res.data.data.icon)</span><br><span class="line">            this.$message(&#123;</span><br><span class="line">              message: &#x27;恭喜你，登录成功&#x27;,</span><br><span class="line">              type: &#x27;success&#x27;</span><br><span class="line">            &#125;);</span><br><span class="line">            // 2. 关闭登录框</span><br><span class="line">            this.close_login()</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            this.$message.error(res.data.msg)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.$message.error(&#x27;用户名和密码必填&#x27;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.login &#123;</span><br><span class="line">  width: 100vw;</span><br><span class="line">  height: 100vh;</span><br><span class="line">  position: fixed;</span><br><span class="line">  top: 0;</span><br><span class="line">  left: 0;</span><br><span class="line">  z-index: 10;</span><br><span class="line">  background-color: rgba(0, 0, 0, 0.3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box &#123;</span><br><span class="line">  width: 400px;</span><br><span class="line">  height: 420px;</span><br><span class="line">  background-color: white;</span><br><span class="line">  border-radius: 10px;</span><br><span class="line">  position: relative;</span><br><span class="line">  top: calc(50vh - 210px);</span><br><span class="line">  left: calc(50vw - 200px);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-icon-close &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  top: 10px;</span><br><span class="line">  right: 10px;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-icon-close:hover &#123;</span><br><span class="line">  color: darkred;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 40px;</span><br><span class="line">  width: 280px;</span><br><span class="line">  left: 60px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav &#123;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  height: 38px;</span><br><span class="line">  border-bottom: 2px solid darkgrey;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav &gt; span &#123;</span><br><span class="line">  margin: 0 20px 0 35px;</span><br><span class="line">  color: darkgrey;</span><br><span class="line">  user-select: none;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  padding-bottom: 10px;</span><br><span class="line">  border-bottom: 2px solid darkgrey;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav &gt; span.active &#123;</span><br><span class="line">  color: black;</span><br><span class="line">  border-bottom: 3px solid black;</span><br><span class="line">  padding-bottom: 9px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-input, .el-button &#123;</span><br><span class="line">  margin-top: 40px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-button &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.foot &gt; span &#123;</span><br><span class="line">  float: right;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line">  color: orange;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.sms &#123;</span><br><span class="line">  color: orange;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  width: 70px;</span><br><span class="line">  text-align: center;</span><br><span class="line">  user-select: none;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Register-vue-1"><a href="#Register-vue-1" class="headerlink" title="Register.vue"></a><code>Register.vue</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;register&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-close&quot; @click=&quot;close_register&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;div class=&quot;content&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;nav&quot;&gt;</span><br><span class="line">          &lt;span class=&quot;active&quot;&gt;新用户注册&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;el-form&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">              placeholder=&quot;手机号&quot;</span><br><span class="line">              prefix-icon=&quot;el-icon-phone-outline&quot;</span><br><span class="line">              v-model=&quot;mobile&quot;</span><br><span class="line">              clearable</span><br><span class="line">              @blur=&quot;check_mobile&quot;&gt;</span><br><span class="line">          &lt;/el-input&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">              placeholder=&quot;密码&quot;</span><br><span class="line">              prefix-icon=&quot;el-icon-key&quot;</span><br><span class="line">              v-model=&quot;password&quot;</span><br><span class="line">              clearable</span><br><span class="line">              show-password&gt;</span><br><span class="line">          &lt;/el-input&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">              placeholder=&quot;验证码&quot;</span><br><span class="line">              prefix-icon=&quot;el-icon-chat-line-round&quot;</span><br><span class="line">              v-model=&quot;sms&quot;</span><br><span class="line">              clearable&gt;</span><br><span class="line">            &lt;template slot=&quot;append&quot;&gt;</span><br><span class="line">              &lt;span class=&quot;sms&quot; @click=&quot;send_sms&quot;&gt;&#123;&#123; sms_interval &#125;&#125;&lt;/span&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">          &lt;/el-input&gt;</span><br><span class="line">          &lt;el-button type=&quot;primary&quot; @click=&quot;handleRegister&quot;&gt;注册&lt;/el-button&gt;</span><br><span class="line">        &lt;/el-form&gt;</span><br><span class="line">        &lt;div class=&quot; foot</span><br><span class="line">          &quot;&gt;</span><br><span class="line">          &lt;span @click=&quot;go_login&quot;&gt;立即登录&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;Register&quot;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      mobile: &#x27;&#x27;,</span><br><span class="line">      password: &#x27;&#x27;,</span><br><span class="line">      sms: &#x27;&#x27;,</span><br><span class="line">      sms_interval: &#x27;获取验证码&#x27;,</span><br><span class="line">      is_send: false,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    close_register() &#123;</span><br><span class="line">      this.$emit(&#x27;close&#x27;, false)</span><br><span class="line">    &#125;,</span><br><span class="line">    go_login() &#123;</span><br><span class="line">      this.$emit(&#x27;go&#x27;)</span><br><span class="line">    &#125;,</span><br><span class="line">    check_mobile() &#123;</span><br><span class="line">      if (!this.mobile) return;</span><br><span class="line">      if (!this.mobile.match(/^1[3-9][0-9]&#123;9&#125;$/)) &#123;</span><br><span class="line">        this.$message(&#123;</span><br><span class="line">          message: &#x27;手机号有误&#x27;,</span><br><span class="line">          type: &#x27;warning&#x27;,</span><br><span class="line">          duration: 1000,</span><br><span class="line">          onClose: () =&gt; &#123;</span><br><span class="line">            this.mobile = &#x27;&#x27;;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        return false;</span><br><span class="line">      &#125;</span><br><span class="line">      this.is_send = true;</span><br><span class="line">    &#125;,</span><br><span class="line">    send_sms() &#123;</span><br><span class="line">      if (!this.is_send) return;</span><br><span class="line">      this.is_send = false;</span><br><span class="line">      let sms_interval_time = 60;</span><br><span class="line">      this.sms_interval = &quot;发送中...&quot;;</span><br><span class="line">      let timer = setInterval(() =&gt; &#123;</span><br><span class="line">        if (sms_interval_time &lt;= 1) &#123;</span><br><span class="line">          clearInterval(timer);</span><br><span class="line">          this.sms_interval = &quot;获取验证码&quot;;</span><br><span class="line">          this.is_send = true; // 重新回复点击发送功能的条件</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          sms_interval_time -= 1;</span><br><span class="line">          this.sms_interval = `$&#123;sms_interval_time&#125;秒后再发`;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, 1000);</span><br><span class="line">      // 发送短信</span><br><span class="line">      this.$axios.get(this.$settings.base_url + &#x27;user/send/send_message/?phone=&#x27; + this.mobile).then(</span><br><span class="line">          res =&gt; &#123;</span><br><span class="line">            if (res.data.status == 100) &#123;</span><br><span class="line">              this.$message(&#123;</span><br><span class="line">                message: &#x27;验证码发送成功&#x27;,</span><br><span class="line">                type: &#x27;success&#x27;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">              this.$message(&#123;</span><br><span class="line">                message: &#x27;验证码发送失败，请稍后再试&#x27;,</span><br><span class="line">                type: &#x27;warning&#x27;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      )</span><br><span class="line">    &#125;,</span><br><span class="line">    handleRegister() &#123;</span><br><span class="line">      if (this.mobile &amp;&amp; this.sms &amp;&amp; this.password) &#123;</span><br><span class="line">        // 向后端请求</span><br><span class="line">        this.$axios.post(this.$settings.base_url + &#x27;user/register/&#x27;,</span><br><span class="line">            &#123;</span><br><span class="line">              mobile: this.mobile,</span><br><span class="line">              code: this.sms,</span><br><span class="line">              password: this.password,</span><br><span class="line">            &#125;).then(res =&gt; &#123;</span><br><span class="line">          if (res.data.status == 100) &#123;</span><br><span class="line">            console.log(res.data)</span><br><span class="line">            this.$message(&#123;</span><br><span class="line">              message: &#x27;恭喜你，注册成功&#x27;,</span><br><span class="line">              type: &#x27;success&#x27;</span><br><span class="line">            &#125;);</span><br><span class="line">            // 关闭注册框</span><br><span class="line">            this.close_register()</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            this.$message.error(res.data.msg)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.$message.error(&#x27;用户名和密码必填&#x27;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.register &#123;</span><br><span class="line">  width: 100vw;</span><br><span class="line">  height: 100vh;</span><br><span class="line">  position: fixed;</span><br><span class="line">  top: 0;</span><br><span class="line">  left: 0;</span><br><span class="line">  z-index: 10;</span><br><span class="line">  background-color: rgba(0, 0, 0, 0.3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box &#123;</span><br><span class="line">  width: 400px;</span><br><span class="line">  height: 480px;</span><br><span class="line">  background-color: white;</span><br><span class="line">  border-radius: 10px;</span><br><span class="line">  position: relative;</span><br><span class="line">  top: calc(50vh - 240px);</span><br><span class="line">  left: calc(50vw - 200px);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-icon-close &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  top: 10px;</span><br><span class="line">  right: 10px;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-icon-close:hover &#123;</span><br><span class="line">  color: darkred;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.content &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 40px;</span><br><span class="line">  width: 280px;</span><br><span class="line">  left: 60px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav &#123;</span><br><span class="line">  font-size: 20px;</span><br><span class="line">  height: 38px;</span><br><span class="line">  border-bottom: 2px solid darkgrey;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav &gt; span &#123;</span><br><span class="line">  margin-left: 90px;</span><br><span class="line">  color: darkgrey;</span><br><span class="line">  user-select: none;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  padding-bottom: 10px;</span><br><span class="line">  border-bottom: 2px solid darkgrey;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.nav &gt; span.active &#123;</span><br><span class="line">  color: black;</span><br><span class="line">  border-bottom: 3px solid black;</span><br><span class="line">  padding-bottom: 9px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-input, .el-button &#123;</span><br><span class="line">  margin-top: 40px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-button &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.foot &gt; span &#123;</span><br><span class="line">  float: right;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line">  color: orange;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.sms &#123;</span><br><span class="line">  color: orange;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  width: 70px;</span><br><span class="line">  text-align: center;</span><br><span class="line">  user-select: none;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/python/" rel="tag"><i class="fa fa-tag"></i> python</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/26caf8d5.html" rel="prev" title="Python中Redis的使用">
                  <i class="fa fa-chevron-left"></i> Python中Redis的使用
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/8576b974.html" rel="next" title="首页主体、轮播功能和跨域问题">
                  首页主体、轮播功能和跨域问题 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">klcc</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">1.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">15:56</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
